<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Write Post</title>

    <link href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css" rel="stylesheet" >
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">
    <link href="/static/pure.css" rel="stylesheet" >
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
    </script>
    <style>
    .pure-img-responsive {
    max-width: 100%;
    height: 500px;
    }
    .post-img {
      padding-top: 1em;
    }
    a:link {
    text-decoration: none;
    color: #22335f ;
    }

    a:visited {
    text-decoration: none;
    }

    a:hover, a:active {
    text-decoration: underline;
    }
    .post-box {
      padding: 0.5em;
    }

    </style>
</head>

<body>
    <div class="home-menu pure-menu pure-menu-horizontal">
        <a href="#" class="pure-menu-heading">cowsource</a>
        <ul class="pure-menu-list">
            <li class="pure-menu-item"><a href="{{url_for('home')}}" class="pure-menu-link">Home</a></li>
            <li class="pure-menu-item"><a href="{{url_for('about')}}" class="pure-menu-link">About</a></li>
            <li class="pure-menu-item"><a href="{{url_for('makepost')}}" class="pure-menu-link">Make Post</a></li>
            <li class="pure-menu-item"><a href="{{url_for('showposts', limi=30)}}" class="pure-menu-link">Find New</a></li>
        </ul>
    </div>
    <div class="pure-g">
      <div class="pure-u-0 pure-u-lg-1-4"></div>
      <div class="pure-u-1 pure-u-lg-1-2">
	  <img class="pure-img-responsive post-img" src={{posty['file']}}></img>
      </div>
      <div class="pure-u-0 pure-u-lg-1-4"></div>
    </div>

    <div class="pure-g">
    <div class="pure-u-0 pure-u-lg-1-4"></div>
    <div class="pure-u-1-2 pure-u-lg-1-4">
      <p><h1>{{posty['name']}}</h1> <i>from</i> 
        <a style="font-size: 1em;" href="http://yelp.com/biz/{{posty['yelpid']}}">{{posty['yelpname']}}</a></p>
    </div>
    <div class="pure-u-1-2 pure-u-lg-1-4 post-box">
      <p>Price: ${{posty['price']}}</p>
	<a href="{{url_for('user',idu = posty['uid'])}}">{{posty['uname']['name']}} posted this</a>
      </p>
    </div>
    <div classes="pure-u-0 pure-u-lg-1-4"></div>
    </div>
    <div class="pure-g">
      <div class="pure-u-0 pure-u-lg-1-4"></div>
      <div class="pure-u-1-2 pure-u-lg-1-4">
      <button id="like_button" onclick="like()" class="pure-button pure-button-primary">Like</button>
      {% if posty['likes']|length == 1 %} 
      <p id="likes">1 like</p>
      {% else %}
      <p id="likes">{{posty['likes']|length}} likes</p>
      {% endif %}
      <button onclick="see()" class="pure-button pure-button-primary">See who liked this</button>
      <p id="see"></p>
      </div>
      <div class="pure-u-1-2 pure-u-lg-1-4 post-box">
	<p>Description: </p>
	<p>{{posty['description']}}</p>
      </div>
    </div>
    <div class="pure-g">
      <div class="pure-u-0 pure-u-lg-1-4"></div>
      <div class="pure-u-1 pure-u-lg-1-2">
	<p>
		Tags:
    {% for i in range(posty['tags']|length) %}
    {% if i == posty['tags']|length-1 %}
		  {{posty['tags'][i]}}
    {% else %}
      {{posty['tags'][i]}}, 
    {% endif %}  
		{% endfor %}
  </p>
      </div>
      <div class="pure-u-0 pure-u-lg-1-4"></div>
    </div>
    <div class="pure-u-g"></div>
    <div class="pure-u-g"></div>
        <!--
        <div class="pure-control-group">
            <label for="email">Email Address</label>
            <input id="email" type="email" placeholder="Email Address">
        </div>

        <div class="pure-control-group">
            <label for="foo">Supercalifragilistic Label</label>
            <input id="foo" type="text" placeholder="Enter something here...">
        </div>
        !-->
	<script>
	  $SCRIPT_ROOT = {{request.script_root|tojson|safe}};
	  
	  function like(){
	  $.getJSON($SCRIPT_ROOT + "/like", {idu: {{posty['uid']}}, idp: {{posty['_id']}} },
	  function(likes)
	  {$("#likes").text(likes.likes + ' likes');
    console.log(likes);
  })
	  
	  }
	  var display = false;
	  function see(){
	  $.getJSON($SCRIPT_ROOT + "/see",  {idp: {{posty['_id']}} },
	  function(people){
	  display = !display;
	  if(display){
	  $("#see").append("<p id='plist' onclick='close()'></p>");
    if(people.people.length == 0){
      $("#plist").text("No Likes :^(")
    }else{
	  var i;
	  for(i = 0;i < people.people.length; i++){
			$("#plist").append("<a href="+$SCRIPT_ROOT+"/user/"+people.people[i][0]+">"+people.people[i][1]+"</a>");
			console.log(people.people[i])
		}
    }
		}	else {
			$("#see").empty()
			}
			})}
	  </script>
</body>
</html>

<!--<html>
  <head>
  </head>
  <body>
    {'_id':idp, 'tags':tags, 'likes':[], 'name':name, 'price':price, 'description':description, 'file':path, 'uid':idu, 'yelpid':idy}
    <span>id: {{posty['_uid']}}</span>
    <span>tags: {{posty['tags']}}</span>
    <span>likes: {{posty['likes']}}</span>
    <span>name: {{posty['name']}}</span>
    <span>price: {{posty['price']}}</span>
    <span>desc: {{posty['description']}}</span>
    <span>file: {{posty['file']}}</span>
    <span>uid: {{posty['uid']}}</span>
    <span>yelpid: {{posty['yelpid']}}</span>
    </body>
  </html>
!-->
