<!DOCTYPE html>
<html>
	<head>
	<style>
		html, body {
		height:100%;
		margin:0;
		padding:0;
	}
	#map {
		height: 50%;
	}
	</style>
	</head>
	<body>
	<div id = "map"></div>
	<script>
		function initMap() {
			var restaurants = {{rests|tojson|safe}}
			var user = JSON.parse({{user|tojson|safe}})
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom: 9,
				center: user
			});
			var mark = new google.maps.Marker({
				position: user,
				map: map,
				title: 'User'
			});
			for (var i=0; i<restaurants.length; i++) {
				markRest(restaurants[i],map);
			}
		}
		function markRest(jason,mp) {
			var contentString = '<div style="width:150px;height:150px;overflow:hidden;margin:10px;position:relative;">'+
			'<img height=200px width=200px style="position:absolute; left: -1000%; right: -1000%; top: -1000%; bottom: -1000%; margin:auto; min-height: 100%; min-width: 100%;"'+
			'src="'+jason['file']+'"></div><b>'+jason['restaurant']+'<b>';
			
			var rcoord = jason['coords'];
			var rcoords = {lat: rcoord[0],lng: rcoord[1]};		
			var infowindow = new google.maps.InfoWindow({
				content: contentString
			});

			var marker = new google.maps.Marker({
				position: rcoords,
				map: mp,
				title: 'Restaurant'
			});

			marker.addListener('click', function() {
				infowindow.open(mp, marker);
			});
		}
	</script>
	<script src="https://maps.googleapis.com/maps/api/js?signed_in=true&callback=initMap"></script>
	</body>
<html>
